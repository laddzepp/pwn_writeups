
# Сайт: forkbomb
# Автор: @korniltsev (Anatoly Korniltsev)
# Название: echo counter
# Сложность: Easy


В данном задании требуется изменить значение переменной через адрес. Из языка C известно, что через указатели на переменные можно менять значения этих переменных, чтобы это задание решить надо понимать этот момент. Загрузим бинарный файл Ghidra и проанализируем его: <br />
![image](https://github.com/user-attachments/assets/a1ef1646-9467-414a-a290-74f7bf85a6ca)

Итак, у нас имеется переменная `is_admin`, которую надо будет перезаписать. И функция `play`, куда мы передаем адрес переменной `echo_counter`. Если значение переменной `is_admin` ненулевое, тогда 
мы выполняем `system("cat flag")`. Теперь проанализируем функцию `play()`. <br />

![image](https://github.com/user-attachments/assets/ec40b787-1390-4259-854f-206b75ea4a6c)

Видим цикл, который выполняется вечно, если не попадает под условия указанные в `if`. Переменаая `buf` считывается с помощью небезопасной функции `read()`, а значение записанное по адресу, 
которое лежит в `echo_counter` инкрементируется. Также выводится адрес `echo_counter` и значение по адресу.  Как перезаписать данное значение ? Посмотрим в дизассемблер: <br />

![image](https://github.com/user-attachments/assets/28f12f02-9440-4fd3-a9c0-4b9e71e7e209)

Сначала на стеке будет лежать аргумент `echo_counter`, а над ним будет размещаться массив `char buf[8]`. Значит, мы можем переполнить массив `char buf[8]` и перезаписать адрес `echo_counter` на адрес 
переменной `is_admin`. Чтобы выйти из программы отправим еще одну строку, которая будет содрежать символ `q`, чтобы выйти из массива. Для начала узнаем адрес переменной `is_admin`: <br />
![image](https://github.com/user-attachments/assets/fa0ff9c2-5700-44de-aa60-8c3e4722939d)

По традиции пишем скрипт, который находит локальный флаг и если он работает, то отправляем решение на сервер: <br />

```py
from pwn import *
p = process('./echo_counter')
p.sendline(b"A"*12 + p64(0x40408c))
p.sendline(b"q")
p.interactive()
```
![image](https://github.com/user-attachments/assets/8555dcb8-ea69-463b-bb91-3392d3d612f8)

