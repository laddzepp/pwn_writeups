# Сайт: forkbomb.ru 
# Автор: @korniltsev (Anatoly Korniltsev)
# Название: ret
# Сложность: Easy

В предыдущих заданиях мы уже имели дело с перетиранием переменных, теперь же нам предстоит затереть адрес возврата. Адрес возврата это адрес инструкции на которую вернется программа после выполнения инструкции `call`. Приступим к решению.


#### Решение: 

В программе всего три функции: `main`, `win` и `play`:

![image](https://github.com/user-attachments/assets/06a7640b-0680-4d5d-beef-12b2132f2d02) <br />


`play` вызывается внутри функции `main`. Посмотрим на содержимое этой функции: <br />

![image](https://github.com/user-attachments/assets/e43d4d3c-995f-4838-af33-3c7aec6d3788) <br />

Здесь мы видим функцию, которая просто считывает `buf` длиной 8 байт с помощью небезопасной фнукции `read()`. 
Все это создает хорошие условия для переполнения буфера и изменения адреса возврата на нужный. Теперь посмотрим, что делает 
функция `win`: <br />
![image](https://github.com/user-attachments/assets/18956d69-e589-4c73-887a-6023e24e1daf) <br />

Функция `win` просто открывает файл с флагом и выводит его содержимое на экран. Посмотрим адрес функции `win` для его дальнейшего использования в 
скрипте, который переполнит буфер и перейдет на нужную функцию: <br />

![image](https://github.com/user-attachments/assets/76d6298f-a3c0-4fa2-921c-f00c538f401a) <br />

Это адрес `0x401162`. Теперь пишем скрипт: <br />

```py
from pwn import * 

p = remote('109.233.56.90', 11605)
p.sendline(b"AAAAAAAAAAAAAAAA" + p64(0x401162))
p.interactive()
```

И получаем ответ: <br />

![image](https://github.com/user-attachments/assets/91130fef-32f8-42af-b5dd-367ec9d688f0) <br />

Ответ:  `spbctf{7f6eba140c378e636419e0259268e546}`









